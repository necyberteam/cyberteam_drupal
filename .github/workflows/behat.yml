name: (M) Behat Tests
on:
  workflow_dispatch:
    inputs:
      database:
        description: 'Recent database dump to use (leave blank to use artifact)'
      sites:
        description: 'Specify which sites to test or leave the default to run all tests.'
        default: 'cci, asp, champ, coco, usrse, careers, gpc, ky, nect'
        required: true
      prnum:
        description: 'Pull request number â€” adds a comment to a pull request (nomally empty)'
permissions:
  contents: write
  actions: read
  pull-requests: write
jobs:
  urse-outputs:
    runs-on: ubuntu-latest
    if: ${{ contains(github.event.inputs.sites, 'urse') }}
    outputs:
      sites: ${{ steps.step1.outputs.sites }}
    steps:
      - name: Print the sites
        id: step1
        run: |
          echo "::set-output name=urse::$SITES"
  urse:
    if: ${{ contains(github.event.inputs.sites, 'urse') }}
    needs:
      - urse-outputs
    uses: necyberteam/reusable_actions/.github/workflows/behat.yml@main
    with:
      sites:  ${{ needs.urse-outputs.outputs.sites }}
